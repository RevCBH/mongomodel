#!/usr/bin/env ruby

puts "Loading MongoModel sandbox..."

$LOAD_PATH.unshift(File.dirname(__FILE__) + '/../lib')

require 'irb'
require 'irb/completion'

require 'mongomodel'

IRB.setup(nil)
irb = IRB::Irb.new

IRB.conf[:MAIN_CONTEXT] = irb.context

examples = <<-EXAMPLES
  
  class Article < MongoModel::Document
    property :title, String
    property :created_at, Time, lambda { Time.now }
    property :published, Boolean, :default => false
    
    named_scope :published, :conditions => { :published => true }
    named_scope :latest, lambda { |num| { :limit => num, :order => 'created_at DESC' } }
  end
  
EXAMPLES

puts examples
irb.context.evaluate(examples, 0)

trap("SIGINT") do
  irb.signal_handle
end
catch(:IRB_EXIT) do
  irb.eval_input
end
